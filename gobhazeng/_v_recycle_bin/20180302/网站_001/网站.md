# 基本配置

jdk：`/gobhazeng/jdk1.8.0_161`
环境变量：`/etc/profile` 修改后需重启

```conf
# /etc/profile: system-wide .profile file for the Bourne shell (sh(1))
# and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).
if [ "$PS1" ]; then
  if [ "$BASH" ] && [ "$BASH" != "/bin/sh" ]; then
    # The file bash.bashrc already sets the default PS1.
    # PS1='\h:\w\$ '
    if [ -f /etc/bash.bashrc ]; then
      . /etc/bash.bashrc
    fi
  else
    if [ "`id -u`" -eq 0 ]; then
      PS1='# '
    else
      PS1='$ '
    fi
  fi
fi

if [ -d /etc/profile.d ]; then
  for i in /etc/profile.d/*.sh; do
    if [ -r $i ]; then
      . $i
    fi
  done
    #Java Environment Path
    export  JAVA_HOME=/gobhazeng/jdk1.8.0_161
    export  CLASSPATH=$:CLASSPATH:$JAVA_HOME/lib/
    export  PATH=$PATH:$JAVA_HOME/bin
  unset i
fi
```

## Tomcat

tomcat：`/gobhazeng/apache-tomcat-9.0.5`

启动tomcat：`/gobhazeng/apache-tomcat-9.0.5/bin/startup.sh`

停止tomcat：`/gobhazeng/apache-tomcat-9.0.5/bin/shutdown.sh`

## Nohup

后台挂载执行，同时将日志重定向到文件中：

`nohup java -jar web-0.0.1-SNAPSHOT.jar >job.txt 2>&1 &`

查看后台运行任务：`jobs`

查看指定编号的任务，并调回前台：`fg`

退出前台任务：`Ctrl+C`

## PHP

启动PHP：`service php7.0-fpm start`

关闭PHP：`service php7.0-fpm stop`

重启PHP：`service php7.0-fpm restart`

## Nginx

主程序：`/usr/sbin/nginx`

存放配置文件：`/etc/nginx`

配置文件地址：`/etc/nginx/sites-available`

存放静态文件：`/usr/share/nginx`

存放日志：`/var/log/nginx`

启动Nginx：`service nginx start`

关闭Nginx：`service nginx stop`

重启Nginx：`service nginx restart`

配置：

```conf
server {
  listen        80;
  server_name   www.gobhazeng.com;

  root          /var/www/html;
  index         index.php;

  location / {
     try_files $uri $uri/ /index.php?$query_string;
  }

  location ~ \.php$ {
    #fastcgi_pass 127.0.0.1:9000;
    fastcgi_pass unix:/run/php/php7.0-fpm.sock;
    fastcgi_index index.php;
    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    include fastcgi_params;
  }
}

```

## Certbot

Certbot获取证书：`./certbot-auto certonly --email admin@gobhazeng.com --agree-tos --webroot -w /var/www/html/ -d www.gobhazeng.com -d gobhazeng.com`

证书地址：`/etc/letsencrypt/live/www.gobhazeng.com`

证书续期：`certbot renew --dry-run`

证书路径：

```conf
SSLCertificateFile /etc/letsencrypt/live/www.gobhazeng.com/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/www.gobhazeng.com/privkey.pem
SSLCertificateChainFile /etc/letsencrypt/live/www.gobhazeng.com/chain.pem
```

生成Perfect Forward Security（PFS）键值：

```conf
mkdir /etc/ssl/private/ -p
cd /etc/ssl/private/
openssl dhparam 2048 -out dhparam.pem
```

Perfect Forward Security（PFS）键值：`/etc/ssl/private/dhparam.pem`

## Apache

启动Apache：`/usr/sbin/apachectl start`
停止Apache：`/usr/sbin/apachectl stop`
重启Apache：`/usr/sbin/apachectl restart`

Ubuntu Apache 加载SSL模块：` a2enmod ssl`
启动SSL站点：`a2ensite default-ssl`
加入监听端口443：`vim /etc/apache2/ports.conf`

配置SSL模块：`vim /etc/apache2/sites-enabled/default-ssl.conf`

强制跳转HTTPS：
`vim /etc/apache2/sites-enabled/000-default.conf`

```conf
RewriteEngine on
RewriteCond  %{HTTPS} !=on
RewriteRule  ^(.*) https://%{SERVER_NAME}$1 [L,R]
```

# AWS

共有DNS（IPV4）：`ec2-18-216-155-9.us-east-2.compute.amazonaws.com`

# Blog

Mysql配置：

```php
// ** MySQL 设置 - 具体信息来自您正在使用的主机 ** //
/** WordPress数据库的名称 */
define('DB_NAME', 'wordpress');

/** MySQL数据库用户名 */
define('DB_USER', 'root');

/** MySQL数据库密码 */
define('DB_PASSWORD', 'dPVq1Rc0GIgIdgxM');

/** MySQL主机 */
define('DB_HOST', 'localhost');

/** 创建数据表时默认的文字编码 */
define('DB_CHARSET', 'utf8');

/** 数据库整理类型。如不确定请勿更改 */
define('DB_COLLATE', '');

/**#@+
 * 身份认证密钥与盐。
 *
 * 修改为任意独一无二的字串！
 * 或者直接访问{@link https://api.wordpress.org/secret-key/1.1/salt/
 * WordPress.org密钥生成服务}
 * 任何修改都会导致所有cookies失效，所有用户将必须重新登录。
 *
 * @since 2.6.0
 */
define('AUTH_KEY',         'fMEb.`bZK^4c#bl0zTc/<5%asR9U9j-tPJSTH$Y<_F],wzPPnOc]o.0)B86|_7g3');
define('SECURE_AUTH_KEY',  'p=nXv0dshh~?S(@XL}siCWFVg3EQ%MdmWON$]zv?.P6ugq:Sdp.w@f{1|(D^>q9z');
define('LOGGED_IN_KEY',    ']Wgk]1[h5Xj3MDWpdK)kIS}T,~[nsrSLL,y)<$1g>nx9+2mtMfNK;uc&r,T|e.Ms');
define('NONCE_KEY',        'r/.+}a^L4|b8 Q;Wr7kv~@&KxB9w, ;Bt,Fq]r+E`2,WIu`V*hB3pTl[7{6x]`0E');
define('AUTH_SALT',        '+=9Mb#Fn.?H.6O&5/gmu[c}IgO1t5>{G>-rUBFik[~asT62RI~*~`dw%<{Q2E>_Y');
define('SECURE_AUTH_SALT', 'sw*H[&AYVI8JD!)W?!o^z!eXg-|x$1D2W%l6~ojR@<6,xHwOGUe~_uQCe*2)w1{w');
define('LOGGED_IN_SALT',   'wH(lUG$t4arCZgb^+Wl]96959*eW0-!EOi-4:^Wa}|YYX*/*R0? ln447(wj~&/$');
define('NONCE_SALT',       ':P.2:)o,;wdPMJ61`ecS7f)t!L$:>-O^m9k3_cB&oNf3Z}e3`(S7Ew0Tosi%&6gI');
```

页面地址：`/var/www/html`

# SpringBoot Demo

## nginx 本地

```conf
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    gzip  on;

    server {
        listen       80;
        server_name  localhost;

        charset UTF-8;

        #access_log  logs/host.access.log  main;

        #项目路径
        location / {
            #root   C:\\Users\\Admin\\Desktop\\synchro\\source\\SpringBootDemo\\gobha\\src\\main\\resources;
            root   C:\\Users\\jimin\\Desktop\\synchro\\source\\SpringBootDemo\\gobha\\src\\main\\resources;
            index  webapps/login.html;
        }

        #接口转发tomcat
        location ^~ /gobha/ {
            proxy_pass http://localhost:8080/dev/;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # proxy the PHP scripts to Apache listening on 127.0.0.1:80
        #
        #location ~ \.php$ {
        #    proxy_pass   http://127.0.0.1;
        #}

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
    }


    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    #server {
    #    listen       8000;
    #    listen       somename:8080;
    #    server_name  somename  alias  another.alias;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}


    # HTTPS server
    #
    #server {
    #    listen       443 ssl;
    #    server_name  localhost;

    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;

    #    ssl_session_cache    shared:SSL:1m;
    #    ssl_session_timeout  5m;

    #    ssl_ciphers  HIGH:!aNULL:!MD5;
    #    ssl_prefer_server_ciphers  on;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}

}
```

## nginx 线上

```conf
server {
  listen 80;
  server_name www.gobhazeng.com gobhazeng.com;
  rewrite ^ https://$server_name$request_uri? permanent;
}

server {
  listen        443 ssl;
  server_name   www.gobhazeng.com gobhazeng.com;

  charset utf-8;

  keepalive_timeout   70;

  ssl_certificate     /etc/letsencrypt/live/www.gobhazeng.com/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/www.gobhazeng.com/privkey.pem;

  ssl_session_cache    shared:SSL:10m;
  ssl_session_timeout  10m;
  ssl_session_tickets on;

  ssl_prefer_server_ciphers on;

  #PFS
  ssl_dhparam /etc/ssl/private/dhparam.pem;

  access_log /etc/nginx/sites-available/access.log;
  error_log /etc/nginx/sites-available/error.log;

  #webapp路径
  location /webapp {
     root       /var/www/;
     index 		login.html;
  }

  #接口转发tomcat
  location ^~ /gobha/ {
     proxy_pass http://localhost:8080/dev/;
  }

  location / {
     root       /var/www/html;
     index 		index.php;
  }

  location ~ \.php$ {
    #fastcgi_pass 127.0.0.1:9000;
    fastcgi_pass unix:/run/php/php7.0-fpm.sock;
    fastcgi_index index.php;
    #fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;
    include fastcgi_params;
  }
}
```